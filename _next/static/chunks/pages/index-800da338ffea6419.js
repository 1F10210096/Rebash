(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9208:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2121)}])},2121:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var n=s(5893),o=s(24),a=s(1163),i=s(7294),l=s(8239);let r=e=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,fill:e.fill,children:(0,n.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});var c=s(1733),d=s(7251),u=s(2038),m=s.n(u);let x=e=>{let{user:t}=e,s=async()=>{confirm("Logout?")&&await (0,d.k)()};return(0,n.jsx)("div",{className:m().container,children:(0,n.jsxs)("div",{className:m().main,children:[(0,n.jsx)("img",{src:c.D.frourio_svg,height:36,alt:"frourio logo"}),(0,n.jsxs)("div",{className:m().userBtn,onClick:s,children:[void 0!==t.photoURL?(0,n.jsx)("img",{className:m().userIcon,src:t.photoURL,height:24,alt:t.displayName}):(0,n.jsx)(r,{size:18,fill:"#555"}),(0,n.jsx)("span",{className:m().userName,children:t.displayName})]})]})})};var _=s(1290),g=s(5371),h=s(2729),p=s.n(h);let v=()=>{let[e]=(0,o.KO)(g.L),[t,s]=(0,i.useState)(""),[r,c]=(0,i.useState)(""),[d,u]=(0,i.useState)([]),[m,h]=(0,i.useState)(""),[v,f]=(0,i.useState)(""),[y,j]=(0,i.useState)([]),[b,w]=(0,i.useState)([]),[S,N]=(0,i.useState)([]),[C,k]=(0,i.useState)([]);(0,a.useRouter)();let[B,I]=(0,i.useState)(""),M=(0,i.useRef)(null),D=(0,i.useRef)(),[E,F]=(0,i.useState)(!1),[R,U]=(0,i.useState)(""),[$,H]=(0,i.useState)(""),[L,O]=(0,i.useState)(""),[T,z]=(0,i.useState)(null),[Z,A]=(0,i.useState)(""),[P,X]=(0,i.useState)(!1),[q,J]=(0,i.useState)(!1),[Q,G]=(0,i.useState)(null),[K,Y]=(0,i.useState)({x:0,y:0});(0,i.useEffect)(()=>{let e=async()=>{D.current=await navigator.mediaDevices.getUserMedia({video:!0}),M.current&&(M.current.srcObject=D.current)},t=()=>{D.current&&D.current.getTracks()[0].stop()};return e(),()=>{t()}},[]);let V=(0,i.useCallback)(async()=>{let e=await _.x.roomlist.$post();console.log(e),u(e.roomId)},[]),W=(0,i.useCallback)(async()=>{let t=await _.x.roomlist.$post();if(console.log(t),null===t)console.log("a"),await _.x.create.$post();else if(null===e)console.log(e);else{let t=e.id,s=await _.x.usercheck.$post({body:{userId:t}});console.log(s)}},[e]),ee=e=>{s(e.target.value)},et=e=>{U(e.target.value)},es=e=>{h(e.target.value)},en=async s=>{if(s.preventDefault(),console.log("a"),!e)return;let n=e.id,o=await _.x.user.post({body:{roomId:t,userId:n}});await _.x.roomcreate.post({body:{roomId:t,userId:n}}),console.log(t),u(o.body.roomId)},eo=async s=>{if(s.preventDefault(),!e)return;let n=e.id;console.log(R);let o=await _.x.serchroom.post({body:{searchRoomId:R,userId:n}});await _.x.userroomcreate.post({body:{searchRoomId:R,userId:n}}),console.log(o.body.user),console.log(t),c(o.body.roomid),j(o.body.user),await V()},ea=async s=>{if(s.preventDefault(),!e)return;let n=e.id,o=e.displayName;void 0===o?console.log("usernameなし"):await _.x.message.post({body:{roomId:t,sender_id:n,content:m,name:o}}),await el()},ei=async t=>{if(s(t),await _.x.room.post({body:{roomId3:t}}),null===e)console.log("error");else{let s=e.id;console.log(s);let n=await _.x.roomuser.post({body:{roomId3:t}});console.log(n.body.user),j(n.body.user)}let n=await _.x.message_get2.$post({body:{roomId3:t}});console.log(n),void 0===n?console.log("messagesがありません"):(w(n),f((null==e?void 0:e.id)||""))},el=async()=>{let s=await _.x.message_get.$post({body:{roomId:t}});void 0===s?console.log("messagesがありません"):(w(s),f((null==e?void 0:e.id)||""))},er=async e=>{try{let t=await _.x.infomessage.$post({body:{messageId:e}});O(t.sender_Id),await el()}catch(e){await el()}},ec=async e=>{try{await _.x.deleteMessage.$post({body:{messageId:e}}),await el()}catch(e){await el()}},ed=()=>{F(!E)},eu=(e,t)=>{z(e),A(t),X(!1),J(!0),H(t)},em=async()=>{J(!1),null===T&&console.log("id2なし"),await _.x.edit.$post({body:{editingMessageId:T,editedMessage:Z}}),await el(),z(null),A("")},ex=(e,t)=>s=>{s.preventDefault(),X(!0),G(e),Y({x:s.clientX,y:s.clientY}),z(e),A(t),H(t)};return((0,i.useEffect)(()=>{W(),V()},[V,W]),e)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{user:e}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["User: ",e.id]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:p().currentroomId,children:[(0,n.jsxs)("p",{children:["現在のRoom ID: ",t]}),(0,n.jsx)("p",{children:y})]}),(0,n.jsxs)("div",{className:p().roomIds,children:[(0,n.jsx)("p",{children:"Room IDs:"}),d.map(e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("p",{onClick:()=>ei(e),children:e},e)}))]}),(0,n.jsx)("div",{})]})]}),(0,n.jsx)("div",{className:p().comment,children:b.sort((e,t)=>e.sent_at-t.sent_at).map(e=>(0,n.jsxs)("div",{className:"".concat(p().commentBubble," ").concat(e.sender_Id===v?p().myMessage:p().otherMessage),onContextMenu:ex(e.id2,e.contentmess),children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:p().username,children:e.sender_Id===v?null:e.username}),(0,n.jsx)("div",{className:p().username,children:e.sender_Id===v?e.username:null})]}),P&&Q===e.id2&&(0,n.jsxs)("div",{className:p().contextMenu,style:{top:K.y,left:K.x},children:[(0,n.jsx)("div",{onClick:()=>eu(e.id2,e.contentmess),children:"Edit"}),(0,n.jsx)("div",{onClick:()=>ec(e.id2),children:"Delete"}),(0,n.jsx)("div",{onClick:()=>er(e.id2),children:"info"})]}),!0===q&&T===e.id2?(0,n.jsxs)("div",{className:p().editForm,children:[(0,n.jsx)("input",{type:"text",value:$,onChange:t=>eu(e.id2,t.target.value)}),(0,n.jsx)("button",{onClick:()=>em(),children:"Save"}),(0,n.jsx)("button",{onClick:()=>z(null),children:"Cancel"})]}):(0,n.jsx)("div",{children:e.contentmess})]},e.id2))}),(0,n.jsx)("div",{className:p().form,children:(0,n.jsxs)("form",{style:{marginLeft:"700px"},onSubmit:ea,children:[(0,n.jsx)("input",{value:m,type:"text",onChange:es}),(0,n.jsx)("input",{type:"submit",value:"  createcomment  "})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{className:p().btn_25,onClick:ed,style:{marginLeft:"100px"},children:"Toggle Form"}),(0,n.jsx)("div",{className:p().crateButton,children:E&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:en,children:[(0,n.jsx)("input",{value:t,type:"text",onChange:ee,placeholder:"Room ID"}),(0,n.jsx)("input",{type:"submit",value:"Create"})]}),(0,n.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:eo,children:[(0,n.jsx)("input",{value:R,type:"text",onChange:et,placeholder:"Search Room ID"}),(0,n.jsx)("input",{type:"submit",value:"Search"})]})]})})]})]}):(0,n.jsx)(l.g,{visible:!0})};var f=v},7251:function(e,t,s){"use strict";s.d(t,{_:function(){return i},k:function(){return l}});var n=s(7908),o=s(328),a=s(3377);let i=async()=>{let e=new n.GH;e.addScope("read:user"),await (0,n.rh)((0,o.l)(),e).catch(a.F)},l=async()=>{await (0,o.l)().signOut()}},2038:function(e){e.exports={container:"BasicHeader_container__5rTZS",main:"BasicHeader_main__yd6De",userBtn:"BasicHeader_userBtn__B7CLf",userIcon:"BasicHeader_userIcon__fjiOn",userName:"BasicHeader_userName__vjAjN"}},2729:function(e){e.exports={title:"index_title__gEapU",tasks:"index_tasks__T3_J7",deleteBtn:"index_deleteBtn__DU3nM",roomIds:"index_roomIds__mF8xa",comment:"index_comment__q78Pf",form:"index_form__Hw_Cf",myMessage:"index_myMessage__66zcM",otherMessage:"index_otherMessage__dfNSA",commentBubble:"index_commentBubble__ZShOc",currentroomId:"index_currentroomId__0SJgo",roomContainer:"index_roomContainer__2kFkE",commentContainer:"index_commentContainer__OLZg8",username:"index_username__QQaBM",messageContent:"index_messageContent__X0ZUZ",toggleButton:"index_toggleButton__gIdcp",crateButton:"index_crateButton__6qcJ8",btn_25:"index_btn_25__tqwog",contextMenu:"index_contextMenu__8M9n4",before:"index_before__nn_6y",after:"index_after__91Hov",btn:"index_btn__mP8IA","btn-gradient":"index_btn-gradient__79vUN",editForm:"index_editForm__nUZR4"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=9208)}),_N_E=e.O()}]);