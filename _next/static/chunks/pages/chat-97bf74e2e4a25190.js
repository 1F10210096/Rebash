(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{1679:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return s(9174)}])},9174:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(5893),n=s(7462),c=s(7294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868.2 377.4c-18.9-45.1-46.3-85.6-81.2-120.6a377.26 377.26 0 00-120.5-81.2A375.65 375.65 0 00519 145.8c-41.9 0-82.9 6.7-121.9 20C306 123.3 200.8 120 170.6 120c-2.2 0-7.4 0-9.4.2-11.9.4-22.8 6.5-29.2 16.4-6.5 9.9-7.7 22.4-3.4 33.5l64.3 161.6a378.59 378.59 0 00-52.8 193.2c0 51.4 10 101 29.8 147.6 18.9 45 46.2 85.6 81.2 120.5 34.7 34.8 75.4 62.1 120.5 81.2C418.3 894 467.9 904 519 904c51.3 0 100.9-10.1 147.7-29.8 44.9-18.9 85.5-46.3 120.4-81.2 34.7-34.8 62.1-75.4 81.2-120.6a376.5 376.5 0 0029.8-147.6c-.2-51.2-10.1-100.8-29.9-147.4zm-66.4 266.5a307.08 307.08 0 01-65.9 98c-28.4 28.5-61.3 50.7-97.7 65.9h-.1c-38 16-78.3 24.2-119.9 24.2a306.51 306.51 0 01-217.5-90.2c-28.4-28.5-50.6-61.4-65.8-97.8v-.1c-16-37.8-24.1-78.2-24.1-119.9 0-55.4 14.8-109.7 42.8-157l13.2-22.1-9.5-23.9L206 192c14.9.6 35.9 2.1 59.7 5.6 43.8 6.5 82.5 17.5 114.9 32.6l19 8.9 19.9-6.8c31.5-10.8 64.8-16.2 98.9-16.2a306.51 306.51 0 01217.5 90.2c28.4 28.5 50.6 61.4 65.8 97.8l.1.1.1.1c16 37.6 24.1 78 24.2 119.8-.1 41.7-8.3 82-24.3 119.8zM681.1 364.2c-20.4 0-37.1 16.7-37.1 37.1v55.1c0 20.4 16.6 37.1 37.1 37.1s37.1-16.7 37.1-37.1v-55.1c0-20.5-16.7-37.1-37.1-37.1zm-175.2 0c-20.5 0-37.1 16.7-37.1 37.1v55.1c0 20.4 16.7 37.1 37.1 37.1 20.5 0 37.1-16.7 37.1-37.1v-55.1c0-20.5-16.7-37.1-37.1-37.1z"}}]},name:"aliwangwang",theme:"outlined"},r=s(2135),l=c.forwardRef(function(e,t){return c.createElement(r.Z,(0,n.Z)({},e,{ref:t,icon:o}))}),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 128c-212.1 0-384 171.9-384 384v360c0 13.3 10.7 24 24 24h184c35.3 0 64-28.7 64-64V624c0-35.3-28.7-64-64-64H200v-48c0-172.3 139.7-312 312-312s312 139.7 312 312v48H688c-35.3 0-64 28.7-64 64v208c0 35.3 28.7 64 64 64h184c13.3 0 24-10.7 24-24V512c0-212.1-171.9-384-384-384zM328 632v192H200V632h128zm496 192H696V632h128v192z"}}]},name:"customer-service",theme:"outlined"},d=c.forwardRef(function(e,t){return c.createElement(r.Z,(0,n.Z)({},e,{ref:t,icon:i}))}),u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zm-280 0c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}},{tag:"path",attrs:{d:"M894 345a343.92 343.92 0 00-189-130v.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l.8 132.6c0 3.2.5 6.4 1.5 9.4a31.95 31.95 0 0040.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-.5.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102zm505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-.2-.1A367.31 367.31 0 00729 676c76.4-105.3 88.8-237.6 44.4-350.4l.6.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z"}},{tag:"path",attrs:{d:"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z"}}]},name:"comment",theme:"outlined"},m=c.forwardRef(function(e,t){return c.createElement(r.Z,(0,n.Z)({},e,{ref:t,icon:u}))}),h=s(7183),_=s(628),x=s(24),g=s(1163),v=s(8239);let p=e=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,fill:e.fill,children:(0,a.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});var f=s(1733),y=s(7251),j=s(2038),b=s.n(j);let w=e=>{let{user:t}=e,s=async()=>{confirm("Logout?")&&await (0,y.k)()};return(0,a.jsx)("div",{className:b().container,children:(0,a.jsxs)("div",{className:b().main,children:[(0,a.jsx)("img",{src:f.D.frourio_svg,height:36,alt:"frourio logo"}),(0,a.jsxs)("div",{className:b().userBtn,onClick:s,children:[void 0!==t.photoURL?(0,a.jsx)("img",{className:b().userIcon,src:t.photoURL,height:24,alt:t.displayName}):(0,a.jsx)(p,{size:18,fill:"#555"}),(0,a.jsx)("span",{className:b().userName,children:t.displayName})]})]})})};var N=s(1290),S=s(5371),C=s(1634),B=s.n(C);let{Header:k,Content:I,Footer:M,Sider:z}=h.Z,Z=()=>{let[e]=(0,x.KO)(S.L),[t,s]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[r,i]=(0,c.useState)([]),[u,h]=(0,c.useState)(""),[p,f]=(0,c.useState)(""),[y,j]=(0,c.useState)([]),[b,C]=(0,c.useState)([]),[k,I]=(0,c.useState)([]),[M,z]=(0,c.useState)([]);(0,g.useRouter)();let[Z,E]=(0,c.useState)(""),R=(0,c.useRef)(null),D=(0,c.useRef)(),[H,F]=(0,c.useState)(!1),[L,O]=(0,c.useState)(""),[T,$]=(0,c.useState)(""),[V,A]=(0,c.useState)(""),[X,P]=(0,c.useState)(null),[U,Y]=(0,c.useState)(""),[G,J]=(0,c.useState)(!1),[K,q]=(0,c.useState)(!1),[Q,W]=(0,c.useState)(null),[ee,et]=(0,c.useState)({x:0,y:0});[l].map((e,t)=>({key:String(t+1),icon:c.createElement(e),label:" ".concat(t+1)})),(0,c.useEffect)(()=>{let e=async()=>{D.current=await navigator.mediaDevices.getUserMedia({video:!0}),R.current&&(R.current.srcObject=D.current)},t=()=>{D.current&&D.current.getTracks()[0].stop()};return e(),()=>{t()}},[]);let es=(0,c.useCallback)(async()=>{let e=await N.x.roomlist.$post();console.log(e),i(e.roomId)},[]),ea=(0,c.useCallback)(async()=>{let t=await N.x.roomlist.$post();if(console.log(t),null===t)console.log("a"),await N.x.create.$post();else if(null===e)console.log(e);else{let t=e.id,s=await N.x.usercheck.$post({body:{userId:t}});console.log(s)}},[e]),en=e=>{s(e.target.value)},ec=e=>{O(e.target.value)},eo=e=>{h(e.target.value)},er=async s=>{if(s.preventDefault(),console.log("a"),!e)return;let a=e.id,n=await N.x.user.post({body:{roomId:t,userId:a}});await N.x.roomcreate.post({body:{roomId:t,userId:a}}),console.log(t),i(n.body.roomId)},el=async s=>{if(s.preventDefault(),!e)return;let a=e.id;console.log(L);let n=await N.x.serchroom.post({body:{searchRoomId:L,userId:a}});await N.x.userroomcreate.post({body:{searchRoomId:L,userId:a}}),console.log(n.body.user),console.log(t),o(n.body.roomid),j(n.body.user),await es()},ei=async s=>{if(s.preventDefault(),!e)return;let a=e.id,n=e.displayName;void 0===n?console.log("usernameなし"):await N.x.message.post({body:{roomId:t,sender_id:a,content:u,name:n}}),await eu()},ed=async t=>{if(s(t),await N.x.room.post({body:{roomId3:t}}),null===e)console.log("error");else{let s=e.id;console.log(s);let a=await N.x.roomuser.post({body:{roomId3:t}});console.log(a.body.user),j(a.body.user)}let a=await N.x.message_get2.$post({body:{roomId3:t}});console.log(a),void 0===a?console.log("messagesがありません"):(C(a),f((null==e?void 0:e.id)||""))},eu=async()=>{let s=await N.x.message_get.$post({body:{roomId:t}});void 0===s?console.log("messagesがありません"):(C(s),f((null==e?void 0:e.id)||""))},em=async e=>{try{let t=await N.x.infomessage.$post({body:{messageId:e}});A(t.sender_Id),await eu()}catch(e){await eu()}},eh=async e=>{try{await N.x.deleteMessage.$post({body:{messageId:e}}),await eu()}catch(e){await eu()}},e_=()=>{F(!H)},ex=(e,t)=>{P(e),Y(t),J(!1),q(!0),$(t)},eg=async()=>{q(!1),null===X&&console.log("id2なし"),await N.x.edit.$post({body:{editingMessageId:X,editedMessage:U}}),await eu(),P(null),Y("")},ev=(e,t)=>s=>{s.preventDefault(),J(!0),W(e),et({x:s.clientX,y:s.clientY}),P(e),Y(t),$(t)};return((0,c.useEffect)(()=>{ea(),es()},[es,ea]),e)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{user:e}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:["User: ",e.id]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:B().currentroomId,children:[(0,a.jsxs)("p",{children:["現在のRoom ID: ",t]}),(0,a.jsx)("p",{children:y})]}),(0,a.jsxs)("div",{className:B().roomIds,children:[(0,a.jsx)("p",{children:"Room IDs:"}),r.map(e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("p",{onClick:()=>ed(e),children:e},e)}))]}),(0,a.jsx)("div",{})]})]}),(0,a.jsx)("div",{className:B().comment,children:b.sort((e,t)=>e.sent_at-t.sent_at).map(e=>(0,a.jsxs)("div",{className:"".concat(B().commentBubble," ").concat(e.sender_Id===p?B().myMessage:B().otherMessage),onContextMenu:ev(e.id2,e.contentmess),children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:B().username,children:e.sender_Id===p?null:e.username}),(0,a.jsx)("div",{className:B().username,children:e.sender_Id===p?e.username:null})]}),G&&Q===e.id2&&(0,a.jsxs)("div",{className:B().contextMenu,style:{top:ee.y,left:ee.x},children:[(0,a.jsx)("div",{onClick:()=>ex(e.id2,e.contentmess),children:"Edit"}),(0,a.jsx)("div",{onClick:()=>eh(e.id2),children:"Delete"}),(0,a.jsx)("div",{onClick:()=>em(e.id2),children:"info"})]}),!0===K&&X===e.id2?(0,a.jsxs)("div",{className:B().editForm,children:[(0,a.jsx)("input",{type:"text",value:T,onChange:t=>ex(e.id2,t.target.value)}),(0,a.jsx)("button",{onClick:()=>eg(),children:"Save"}),(0,a.jsx)("button",{onClick:()=>P(null),children:"Cancel"})]}):(0,a.jsx)("div",{children:e.contentmess})]},e.id2))}),(0,a.jsx)("div",{className:B().form,children:(0,a.jsxs)("form",{style:{marginLeft:"700px"},onSubmit:ei,children:[(0,a.jsx)("input",{value:u,type:"text",onChange:eo}),(0,a.jsx)("input",{type:"submit",value:"  createcomment  "})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:B().btn_25,onClick:e_,style:{marginLeft:"100px"},children:"Toggle Form"}),(0,a.jsx)("div",{className:B().crateButton,children:H&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:er,children:[(0,a.jsx)("input",{value:t,type:"text",onChange:en,placeholder:"Room ID"}),(0,a.jsx)("input",{type:"submit",value:"Create"})]}),(0,a.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:el,children:[(0,a.jsx)("input",{value:L,type:"text",onChange:ec,placeholder:"Search Room ID"}),(0,a.jsx)("input",{type:"submit",value:"Search"})]})]})})]}),(0,a.jsx)("div",{className:"video-container",children:(0,a.jsx)("video",{ref:R,style:{width:"100%",maxWidth:"100%"},autoPlay:!0,playsInline:!0})}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(_.Z.Group,{trigger:"click",type:"primary",style:{right:24},icon:(0,a.jsx)(d,{}),children:[(0,a.jsx)(_.Z,{}),(0,a.jsx)(_.Z,{icon:(0,a.jsx)(m,{})})]}),(0,a.jsxs)(_.Z.Group,{trigger:"hover",type:"primary",style:{right:94},icon:(0,a.jsx)(d,{}),children:[(0,a.jsx)(_.Z,{}),(0,a.jsx)(_.Z,{icon:(0,a.jsx)(m,{})})]})]})]}):(0,a.jsx)(v.g,{visible:!0})};var E=Z},7251:function(e,t,s){"use strict";s.d(t,{_:function(){return o},k:function(){return r}});var a=s(6240),n=s(328),c=s(3377);let o=async()=>{let e=new a.GH;e.addScope("read:user"),await (0,a.rh)((0,n.l)(),e).catch(c.F)},r=async()=>{await (0,n.l)().signOut()}},2038:function(e){e.exports={container:"BasicHeader_container__5rTZS",main:"BasicHeader_main__yd6De",userBtn:"BasicHeader_userBtn__B7CLf",userIcon:"BasicHeader_userIcon__fjiOn",userName:"BasicHeader_userName__vjAjN"}},1634:function(e){e.exports={title:"chat_title__Snu28",tasks:"chat_tasks__0B7ZY",deleteBtn:"chat_deleteBtn__3eXIO",roomIds:"chat_roomIds____AqH",comment:"chat_comment__F8UVK",form:"chat_form__tjMP8",myMessage:"chat_myMessage__hdJnJ",otherMessage:"chat_otherMessage__yyNOl",commentBubble:"chat_commentBubble__X6BbX",currentroomId:"chat_currentroomId__xyHNh",roomContainer:"chat_roomContainer__5bt_8",commentContainer:"chat_commentContainer__IkVN_",username:"chat_username__YaPG7",messageContent:"chat_messageContent__6gZBg",toggleButton:"chat_toggleButton__LMmYY",crateButton:"chat_crateButton__rz1Ob",btn_25:"chat_btn_25__t6LT5",contextMenu:"chat_contextMenu__naRy_",before:"chat_before__vS88Q",after:"chat_after__lKsmN",btn:"chat_btn__FJky3","btn-gradient":"chat_btn-gradient__JTNI2",editForm:"chat_editForm__klhxE"}}},function(e){e.O(0,[9,774,888,179],function(){return e(e.s=1679)}),_N_E=e.O()}]);