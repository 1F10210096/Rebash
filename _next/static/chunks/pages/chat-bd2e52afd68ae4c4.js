(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{1679:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return s(1323)}])},1323:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(5893),n=s(24),o=s(1163),l=s(7294),r=s(8239);let i=e=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:e.size,height:e.size,fill:e.fill,children:(0,a.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm7.753 18.305c-.261-.586-.789-.991-1.871-1.241-2.293-.529-4.428-.993-3.393-2.945 3.145-5.942.833-9.119-2.489-9.119-3.388 0-5.644 3.299-2.489 9.119 1.066 1.964-1.148 2.427-3.393 2.945-1.084.25-1.608.658-1.867 1.246-1.405-1.723-2.251-3.919-2.251-6.31 0-5.514 4.486-10 10-10s10 4.486 10 10c0 2.389-.845 4.583-2.247 6.305z"})});var c=s(1733),d=s(7251),u=s(2038),m=s.n(u);let _=e=>{let{user:t}=e,s=async()=>{confirm("Logout?")&&await (0,d.k)()};return(0,a.jsx)("div",{className:m().container,children:(0,a.jsxs)("div",{className:m().main,children:[(0,a.jsx)("img",{src:c.D.frourio_svg,height:36,alt:"frourio logo"}),(0,a.jsxs)("div",{className:m().userBtn,onClick:s,children:[void 0!==t.photoURL?(0,a.jsx)("img",{className:m().userIcon,src:t.photoURL,height:24,alt:t.displayName}):(0,a.jsx)(i,{size:18,fill:"#555"}),(0,a.jsx)("span",{className:m().userName,children:t.displayName})]})]})})};var h=s(1290),x=s(5371),g=s(1634),p=s.n(g);let y=()=>{let[e]=(0,n.KO)(x.L),[t,s]=(0,l.useState)(""),[i,c]=(0,l.useState)(""),[d,u]=(0,l.useState)([]),[m,g]=(0,l.useState)(""),[y,v]=(0,l.useState)(""),[j,f]=(0,l.useState)([]),[b,w]=(0,l.useState)([]),[N,S]=(0,l.useState)([]),[C,k]=(0,l.useState)([]);(0,o.useRouter)();let[B,I]=(0,l.useState)(""),M=(0,l.useRef)(null),D=(0,l.useRef)(),[F,R]=(0,l.useState)(!1),[E,L]=(0,l.useState)(""),[O,T]=(0,l.useState)(""),[$,H]=(0,l.useState)(""),[z,X]=(0,l.useState)(null),[U,Y]=(0,l.useState)(""),[A,J]=(0,l.useState)(!1),[P,K]=(0,l.useState)(!1),[Z,G]=(0,l.useState)(null),[V,q]=(0,l.useState)({x:0,y:0});(0,l.useEffect)(()=>{let e=async()=>{D.current=await navigator.mediaDevices.getUserMedia({video:!0}),M.current&&(M.current.srcObject=D.current)},t=()=>{D.current&&D.current.getTracks()[0].stop()};return e(),()=>{t()}},[]);let Q=(0,l.useCallback)(async()=>{let e=await h.x.roomlist.$post();console.log(e),u(e.roomId)},[]),W=(0,l.useCallback)(async()=>{let t=await h.x.roomlist.$post();if(console.log(t),null===t)console.log("a"),await h.x.create.$post();else if(null===e)console.log(e);else{let t=e.id,s=await h.x.usercheck.$post({body:{userId:t}});console.log(s)}},[e]),ee=e=>{s(e.target.value)},et=e=>{L(e.target.value)},es=e=>{g(e.target.value)},ea=async s=>{if(s.preventDefault(),console.log("a"),!e)return;let a=e.id,n=await h.x.user.post({body:{roomId:t,userId:a}});await h.x.roomcreate.post({body:{roomId:t,userId:a}}),console.log(t),u(n.body.roomId)},en=async s=>{if(s.preventDefault(),!e)return;let a=e.id;console.log(E);let n=await h.x.serchroom.post({body:{searchRoomId:E,userId:a}});await h.x.userroomcreate.post({body:{searchRoomId:E,userId:a}}),console.log(n.body.user),console.log(t),c(n.body.roomid),f(n.body.user),await Q()},eo=async s=>{if(s.preventDefault(),!e)return;let a=e.id,n=e.displayName;void 0===n?console.log("usernameなし"):await h.x.message.post({body:{roomId:t,sender_id:a,content:m,name:n}}),await er()},el=async t=>{if(s(t),await h.x.room.post({body:{roomId3:t}}),null===e)console.log("error");else{let s=e.id;console.log(s);let a=await h.x.roomuser.post({body:{roomId3:t}});console.log(a.body.user),f(a.body.user)}let a=await h.x.message_get2.$post({body:{roomId3:t}});console.log(a),void 0===a?console.log("messagesがありません"):(w(a),v((null==e?void 0:e.id)||""))},er=async()=>{let s=await h.x.message_get.$post({body:{roomId:t}});void 0===s?console.log("messagesがありません"):(w(s),v((null==e?void 0:e.id)||""))},ei=async e=>{try{let t=await h.x.infomessage.$post({body:{messageId:e}});H(t.sender_Id),await er()}catch(e){await er()}},ec=async e=>{try{await h.x.deleteMessage.$post({body:{messageId:e}}),await er()}catch(e){await er()}},ed=()=>{R(!F)},eu=(e,t)=>{X(e),Y(t),J(!1),K(!0),T(t)},em=async()=>{K(!1),null===z&&console.log("id2なし"),await h.x.edit.$post({body:{editingMessageId:z,editedMessage:U}}),await er(),X(null),Y("")},e_=(e,t)=>s=>{s.preventDefault(),J(!0),G(e),q({x:s.clientX,y:s.clientY}),X(e),Y(t),T(t)};return((0,l.useEffect)(()=>{W(),Q()},[Q,W]),e)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_,{user:e}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:["User: ",e.id]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:p().currentroomId,children:[(0,a.jsxs)("p",{children:["現在のRoom ID: ",t]}),(0,a.jsx)("p",{children:j})]}),(0,a.jsxs)("div",{className:p().roomIds,children:[(0,a.jsx)("p",{children:"Room IDs:"}),d.map(e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("p",{onClick:()=>el(e),children:e},e)}))]}),(0,a.jsx)("div",{})]})]}),(0,a.jsx)("div",{className:p().comment,children:b.sort((e,t)=>e.sent_at-t.sent_at).map(e=>(0,a.jsxs)("div",{className:"".concat(p().commentBubble," ").concat(e.sender_Id===y?p().myMessage:p().otherMessage),onContextMenu:e_(e.id2,e.contentmess),children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:p().username,children:e.sender_Id===y?null:e.username}),(0,a.jsx)("div",{className:p().username,children:e.sender_Id===y?e.username:null})]}),A&&Z===e.id2&&(0,a.jsxs)("div",{className:p().contextMenu,style:{top:V.y,left:V.x},children:[(0,a.jsx)("div",{onClick:()=>eu(e.id2,e.contentmess),children:"Edit"}),(0,a.jsx)("div",{onClick:()=>ec(e.id2),children:"Delete"}),(0,a.jsx)("div",{onClick:()=>ei(e.id2),children:"info"})]}),!0===P&&z===e.id2?(0,a.jsxs)("div",{className:p().editForm,children:[(0,a.jsx)("input",{type:"text",value:O,onChange:t=>eu(e.id2,t.target.value)}),(0,a.jsx)("button",{onClick:()=>em(),children:"Save"}),(0,a.jsx)("button",{onClick:()=>X(null),children:"Cancel"})]}):(0,a.jsx)("div",{children:e.contentmess})]},e.id2))}),(0,a.jsx)("div",{className:p().form,children:(0,a.jsxs)("form",{style:{marginLeft:"700px"},onSubmit:eo,children:[(0,a.jsx)("input",{value:m,type:"text",onChange:es}),(0,a.jsx)("input",{type:"submit",value:"  createcomment  "})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{className:p().btn_25,onClick:ed,style:{marginLeft:"100px"},children:"Toggle Form"}),(0,a.jsx)("div",{className:p().crateButton,children:F&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:ea,children:[(0,a.jsx)("input",{value:t,type:"text",onChange:ee,placeholder:"Room ID"}),(0,a.jsx)("input",{type:"submit",value:"Create"})]}),(0,a.jsxs)("form",{style:{textAlign:"left",marginTop:"50px"},onSubmit:en,children:[(0,a.jsx)("input",{value:E,type:"text",onChange:et,placeholder:"Search Room ID"}),(0,a.jsx)("input",{type:"submit",value:"Search"})]})]})})]})]}):(0,a.jsx)(r.g,{visible:!0})};var v=y},7251:function(e,t,s){"use strict";s.d(t,{_:function(){return l},k:function(){return r}});var a=s(6467),n=s(328),o=s(3377);let l=async()=>{let e=new a.GH;e.addScope("read:user"),await (0,a.rh)((0,n.l)(),e).catch(o.F)},r=async()=>{await (0,n.l)().signOut()}},2038:function(e){e.exports={container:"BasicHeader_container__5rTZS",main:"BasicHeader_main__yd6De",userBtn:"BasicHeader_userBtn__B7CLf",userIcon:"BasicHeader_userIcon__fjiOn",userName:"BasicHeader_userName__vjAjN"}},1634:function(e){e.exports={title:"chat_title__Snu28",tasks:"chat_tasks__0B7ZY",deleteBtn:"chat_deleteBtn__3eXIO",roomIds:"chat_roomIds____AqH",comment:"chat_comment__F8UVK",form:"chat_form__tjMP8",myMessage:"chat_myMessage__hdJnJ",otherMessage:"chat_otherMessage__yyNOl",commentBubble:"chat_commentBubble__X6BbX",currentroomId:"chat_currentroomId__xyHNh",roomContainer:"chat_roomContainer__5bt_8",commentContainer:"chat_commentContainer__IkVN_",username:"chat_username__YaPG7",messageContent:"chat_messageContent__6gZBg",toggleButton:"chat_toggleButton__LMmYY",crateButton:"chat_crateButton__rz1Ob",btn_25:"chat_btn_25__t6LT5",contextMenu:"chat_contextMenu__naRy_",before:"chat_before__vS88Q",after:"chat_after__lKsmN",btn:"chat_btn__FJky3","btn-gradient":"chat_btn-gradient__JTNI2",editForm:"chat_editForm__klhxE"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1679)}),_N_E=e.O()}]);